---
sidebar_position: 1
displayed_sidebar: apiSidebar
hide_table_of_contents: true
---

# Users

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gridGap: '1rem' }}>
  <div>
    This object represents an end-user within an event organization. Users can be attendees, vendors, performers, staff, etc.
  </div>
  <restList>
    <restElement method='POST' path='/api/users/manual' anchor='create-a-user' />
    <restElement method='GET' path='/api/users/:id' anchor='retrieve-a-user' />
    <restElement method='PATCH' path='/api/users/:id' anchor='update-a-user' />
    <restElement method='DELETE' path='/api/users/:id/pii' anchor='delete-a-users-pii' />
  </restList>
</div>

### Create a User
:::caution
Using the `/api/users` endpoint to create a user is not recommended as captcha verification may be required. Please use the `/api/users/manual` endpoint documented below.
:::

Creates a new user with the given information, bypassing the prior ban check. *This behaviour may change in the future.*

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gridGap: '1rem' }}>
  <div>
    <h4>Permissions</h4>
    <div>
      Requires the <code>user:create</code> permission.
    </div>
    <div style={{ marginBottom: '1.5rem' }} />
    <h4>Attributes</h4>
    <attribute id="user-create-addressCity" name="addressCity" type="string">
      City, town, or village of the user's address.
    </attribute>
    <attribute id="user-create-addressCountry" name="addressCity" type="string">
      Two-letter ISO 3166-1 alpha-2 country code.
    </attribute>
    <attribute id="user-create-addressLine1" name="addressLine1" type="string">
      First line of the user's address. (e.g. 1234 Main St)
    </attribute>
    <attribute id="user-create-addressLine2" name="addressLine2" type="string" optional>
      Optional second line of the user's address. (e.g. Suite 100, Apt 2B)
    </attribute>
    <attribute id="user-create-addressState" name="addressState" type="string">
      State or province of the user's address.
    </attribute>
    <attribute id="user-create-addressZipcode" name="addressZipcode" type="string">
      ZIP or postal code of the user's address.
    </attribute>
    <attribute id="user-create-bornAt" name="bornAt" type="string">
      The date the user was born, in ISO 8601 format.
    </attribute>
    <attribute id="user-create-email" name="email" type="string">
      The user's email address.
    </attribute>
    <attribute id="user-create-firstName" name="firstName" type="string">
      The user's legal first name, as it appears on their ID.
    </attribute>
    <attribute id="user-create-lastName" name="lastName" type="string">
      The user's legal last name, as it appears on their ID.
    </attribute>
    <attribute id="user-create-phone" name="phone" type="string">
      Phone number in international format. (e.g. +15555555555)
    </attribute>
    <attribute id="user-create-preferredName" name="preferredName" type="string" optional>
      An optional preferred name for the user. This will be displayed first on the user's profile.
    </attribute>
    <attribute id="user-create-reason" name="reason" type="string, min. 10 chars">
      A brief reason explaining why the user is being created. This will be saved to the audit log.
    </attribute>
    <attribute id="user-create-username" name="username" type="string">
      The user's username.
    </attribute>
    <div style={{ marginBottom: '1.5rem' }} />
    <h4>Response</h4>
    <attribute id="user-create-resp-id" name="id" type="number" response>
      Returns the ID of the newly created user.
    </attribute>
  </div>
  <div>
    <endpointRequest method='POST' path='/api/users/manual'>
      {`{
  "addressCity": "New York",
  "addressCountry": "US",
  "addressLine1": "123 Main St",
  "addressState": "NY",
  "addressZipcode": "10001",
  "bornAt": "1990-01-01T00:00:00.000Z",
  "email": "aperson@example.com",
  "firstName": "John",
  "lastName": "Doe",
  "password": "areallysecurepassword",
  "preferredName": "Jonathan",
  "reason": "Auto-generated user from external SSO",
  "username": "jdoe",
}`}
    </endpointRequest>
    <endpointResponse>
      {`{
  "id": 1234,
}`}
    </endpointResponse>
  </div>
</div>

### Retrieve a User
Returns the user object for the given ID.

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gridGap: '1rem' }}>
  <div>
    <h4>Permissions</h4>
    <div>
      Requires the <code>system:login</code> permission. Other permissions are required to access additional information, such as PII and order history.
    </div>
    <div style={{ marginBottom: '1.5rem' }} />
    <h4>Attributes</h4>
    <attribute id="user-retrieve-id" name="id" type="number">
      The ID of the user to retrieve.
    </attribute>
    <div style={{ marginBottom: '1.5rem' }} />
    <h4>Response</h4>
    <attribute id="user-retrieve-resp-bans" name="bans" type="array of Ban" response>
      A list of bans applied to the user.
    </attribute>
    <attribute id="user-retrieve-resp-bornAt" name="bornAt" type="string" response>
      The date the user was born, in ISO 8601 format.
    </attribute>
    <attribute id="user-retrieve-resp-emailMd5" name="emailMd5" type="string" response>
      The MD5 hash of the user's email address.
    </attribute>
    <attribute id="user-retrieve-resp-firstName" name="firstName" type="string" response>
      The user's legal first name, as it appears on their ID.
    </attribute>
    <attribute id="user-retrieve-resp-hasRestrictionNotice" name="hasRestrictionNotice" type="boolean" response>
      Returns true if the user has a note with type <code>restriction</code> on their account.
    </attribute>
    <attribute id="user-retrieve-resp-hasSecondFactor" name="hasSecondFactor" type="boolean" response>
      Returns true if the user has a second factor enabled.
    </attribute>
    <attribute id="user-retrieve-resp-id" name="id" type="number" response>
      The ID of the user.
    </attribute>
    <attribute id="user-retrieve-resp-identity" name="identity" type="Identity" optional response>
      The Identity Verification information for the user.
    </attribute>
    <attribute id="user-retrieve-resp-lastName" name="lastName" type="string" response>
      The user's legal last name, as it appears on their ID.
    </attribute>
    <attribute id="user-retrieve-resp-organizationId" name="organizationId" type="string" response>
      The ID of the organization the user belongs to.
    </attribute>
    <attribute id="user-retrieve-resp-permissions" name="permissions" type="array of string" response>
      The permissions granted to the user.
    </attribute>
    <attribute id="user-retrieve-resp-preferredName" name="preferredName" type="string" optional response>
      An optional preferred name for the user. This will be displayed first on the user's profile.
    </attribute>
    <attribute id="user-retrieve-resp-registration" name="registration" type="Registration" optional response>
      The attendee registration record for the user.
    </attribute>
    <attribute id="user-retrieve-resp-reviewReason" name="reviewReason" type="string" optional response>
      The reason the user requires manual review.
    </attribute>
    <attribute id="user-retrieve-resp-roles" name="roles" type="array of string" response>
      The roles granted to the user.
    </attribute>
    <attribute id="user-retrieve-resp-username" name="username" type="string" response>
      The user's username.
    </attribute>
    <details>
      <summary>Scope Restricted Attributes</summary>
      <div>
        <attribute id="user-retrieve-resp-addressCity" name="addressCity" type="string" response permissions={['registration:read:pii']}>
          City, town, or village of the user's address.
        </attribute>
        <attribute id="user-retrieve-resp-addressCountry" name="addressCountry" type="string" response permissions={['registration:read:pii']}>
          Two-letter ISO 3166-1 alpha-2 country code.
        </attribute>
        <attribute id="user-retrieve-resp-addressLine1" name="addressLine1" type="string" response permissions={['registration:read:pii']}>
          First line of the user's address. (e.g. 1234 Main St)
        </attribute>
        <attribute id="user-retrieve-resp-addressLine2" name="addressLine2" type="string" response permissions={['registration:read:pii']} optional>
          Optional second line of the user's address. (e.g. Suite 100, Apt 2B)
        </attribute>
        <attribute id="user-retrieve-resp-addressState" name="addressState" type="string" response permissions={['registration:read:pii']}>
          State or province of the user's address.
        </attribute>
        <attribute id="user-retrieve-resp-addressZipcode" name="addressZipcode" type="string" response permissions={['registration:read:pii']}>
          ZIP or postal code of the user's address.
        </attribute>
        <attribute id="user-retrieve-resp-email" name="email" type="string" response permissions={['registration:read:pii']}>
          The user's email address.
        </attribute>
        <attribute id="user-retrieve-resp-grants" name="grants" type="array of Grant" response permissions={['order:view']}>
          A list of grants applied to the user.
        </attribute>
        <attribute id="user-retrieve-resp-orders" name="orders" type="array of Order" response permissions={['order:view']}>
          A list of orders the user has made.
        </attribute>
        <attribute id="user-retrieve-resp-phone" name="phone" type="string" response permissions={['registration:read:pii']}>
          Phone number in international format. (e.g. +15555555555)
        </attribute>
      </div>
    </details>
  </div>
  <div>
    <endpointRequest method='GET' path='/api/users/:id' contentType='cURL'>
      {`curl https://reg.cces.dev/api/users/:id \\
  -H "Authorization: Bearer <id>:<secret>"`}
    </endpointRequest>
    <endpointResponse>
      {`{
  "addressCity": "New York",
  "addressCountry": "US",
  "addressLine1": "123 Main St",
  "addressLine2": "Suite 100",
  "addressState": "NY",
  "addressZipcode": "10001",
  "bans": [],
  "bornAt": "1990-01-01T00:00:00.000Z",
  "email": "aperson@example.com",
  "emailMd5": "5d54d73edc3da103d3541cd390fd0897",
  "firstName": "John",
  "grants": [],
  "hasRestrictionNotice": false,
  "hasSecondFactor": false,
  "id": 1234,
  "identity": {
    "firstName": "John",
    "lastName": "Doe",
    "status": "verified",
    "type": "document",
    "bornAt": "1990-01-01T00:00:00.000Z",
  },
  "lastName": "Doe",
  "orders": [],
  "organizationId": "8f6f2588-9175-4cdf-8045-ce51aa7d9e14",
  "permissions": [],
  "phone": "+15555555555",
  "preferredName": "Jonathan",
  "registration": null,
  "reviewReason": null,
  "roles": [],
  "username": "aperson",
}`}
    </endpointResponse>
  </div>
</div>

### Update a User
Modify the target user's attributes. Only the fields specified in the request will be updated and other fields will remain unchanged.

:::note
Attributes such as `id`, `password`, and `username` cannot be updated.
:::

:::caution
If using the OAuth API, attempting to update any fields on the current user's account requires the user's current password.
:::

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gridGap: '1rem' }}>
  <div>
    <h4>Permissions</h4>
    <div>
      Requires the <code>user:update</code> permission.
    </div>
    <div style={{ marginBottom: '1.5rem' }} />
    <h4>Attributes</h4>
    <attribute id="user-update-addressLine1" name="addressLine1" type="string" optional>
      First line of the user's address. (e.g. 1234 Main St)
    </attribute>
    <attribute id="user-update-addressLine2" name="addressLine2" type="string" optional>
      Optional second line of the user's address. (e.g. Suite 100, Apt 2B)
    </attribute>
    <attribute id="user-update-addressCity" name="addressCity" type="string" optional>
      City, town, or village of the user's address.
    </attribute>
    <attribute id="user-update-addressCountry" name="addressCountry" type="string" optional>
      Two-letter ISO 3166-1 alpha-2 country code.
    </attribute>
    <attribute id="user-update-addressState" name="addressState" type="string" optional>
      State or province of the user's address.
    </attribute>
    <attribute id="user-update-addressZipcode" name="addressZipcode" type="string" optional>
      ZIP or postal code of the user's address.
    </attribute>
    <attribute id="user-update-bornAt" name="bornAt" type="string" optional>
      Date of birth in ISO 8601 format. (e.g. 1990-01-01)
    </attribute>
    <attribute id="user-update-email" name="email" type="string" optional>
      The user's email address.
    </attribute>
    <attribute id="user-update-firstName" name="firstName" type="string" optional>
      The user's legal first name, as it appears on their ID.
    </attribute>
    <attribute id="user-update-lastName" name="lastName" type="string" optional>
      The user's legal last name, as it appears on their ID.
    </attribute>
    <attribute id="user-update-phone" name="phone" type="string" optional>
      Phone number in international format. (e.g. +15555555555)
    </attribute>
    <attribute id="user-update-preferredName" name="preferredName" type="string" optional>
      An optional preferred name for the user. This will be displayed first on the user's profile.
    </attribute>
  </div>
  <div>
    <exampleBox header="/api/users/:id" method="PATCH" headerSubText="application/json">
      {`{
  "addressLine1": "123 Main St",
  "addressLine2": "Suite 100",
  "addressCity": "New York",
  "addressCountry": "US",
  "addressState": "NY",
  "addressZipcode": "10001",
  "bornAt": "1990-01-01T00:00:00.000Z",
  "email": "test@example.com",
  "firstName": "John",
  "lastName": "Doe",
  "phone": "+15555555555",
  "preferredName": "Jonathan",
}`}
    </exampleBox>
    <exampleBox header="Response">
      204 No Content
    </exampleBox>
  </div>
</div>

### Delete a User's PII

:::danger
Removing a user's personally identifiable information (PII) is a permanent and irreversible action. Sensitive fields (such as name, address, email, phone number, etc.) will be replaced with a generic placeholder, blank string, or `deleted`.
:::

:::caution
Attempting to delete a banned user's PII will return a 204 No Content, but will not actually delete the user's PII.
:::

Removes all personally identifiable information (PII) from a user record, effectively anonymizing and disabling the user's account.

<div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gridGap: '1rem' }}>
  <div>
    <h4>Permissions</h4>
    <div>
      Requires the <code>pii:admin:delete</code> permission.
    </div>
    <div style={{ marginBottom: '1.5rem' }} />
    <h4>Attributes</h4>
    <attribute id="user-retrieve-id" name="id" type="number">
      The ID of the user to remove PII from.
    </attribute>
    <div style={{ marginBottom: '1.5rem' }} />
    <h4>Response</h4>
    This call will not return a payload, and will return a 204 No Content response irrespective of success or failure.
  </div>
  <div>
    <endpointRequest method='DELETE' path='/api/users/:id/pii' contentType='cURL'>
      {`curl https://reg.cces.dev/api/users/:id/pii \\
  -X DELETE \\
  -H "Authorization: Bearer <id>:<secret>"`}
    </endpointRequest>
    <endpointResponse>
      204 No Content
    </endpointResponse>
  </div>
</div>

